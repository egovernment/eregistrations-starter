'use strict';

var $       = require('./main')
  , forEach = require('./for-each')
  , proto   = require('./element#/main')
  , isArray = require('./is-array');

require('./element#/event');

module.exports = $.checkboxDisable = function (checkbox, controls) {
	var onChange, current, update;

	update = isArray(controls) ? function (disabled) {
		forEach(controls, function (control) {
			control = $(control);
			if (control) control.disabled = disabled;
		});
	} : function (disabled) {
		var control = $(controls);
		if (control) control.disabled = disabled;
	};
	proto.addEvent.call(document, 'change', onChange = function () {
		var el, nu;
		el = $(checkbox);
		if (!el) return;
		nu = el.checked;
		if (nu === current) return;
		update(current = nu);
	});
	if (document.on) {
		document.on('pageload', onChange);
		document.on('db-update', onChange);
	}
	onChange();
	return onChange;
};
