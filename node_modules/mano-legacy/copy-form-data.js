'use strict';

var $              = require('./main');

require('./for-each');

module.exports = $.copyFormData = function (sourceFormId, destinationFormId) {
	//get all form controls
	var controls = $(sourceFormId).elements
	  , destinationForm = $(destinationFormId)
	  , newControl, controlName, modifiedControls = [];

	$.forEach(controls, function (control) {
		//do not copy submit controls
		if (control.type === 'submit') return;
		controlName = control.getAttribute('name');
		if (!destinationForm.elements[controlName]) {
			//create the hidden input
			newControl = document.createElement("input");
			newControl.type = "hidden";
			newControl.name = controlName;
			destinationForm.appendChild(newControl);
		} else {
			newControl = destinationForm.elements[controlName];
		}
		//set it s value
		if ((control.getAttribute('type') === 'radio'
			|| control.getAttribute('type') === 'checkbox')
				&& !control.checked) {
			return;
		}
		if (newControl.value !== control.value) {
			newControl.value = control.value;
			modifiedControls.push(control);
		}
	});
	return modifiedControls;
};
