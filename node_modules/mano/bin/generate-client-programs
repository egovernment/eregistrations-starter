#!/usr/bin/env node

'use strict';

Error.stackTraceLimit = Infinity;

// Prevent EMFILE errors
require('fs2/descriptors-handler')();

var resolve           = require('path').resolve
  , genClientPrograms = require('../scripts/generate-client-programs')

  , stdout = process.stdout.write.bind(process.stdout)
  , program = require('commander').usage('[options] [path]')
	.option('--name <app-name>', "Specific app that should be setup")
	.parse(process.argv)
  , path, name = program.name;

path = program.args.length ? resolve(program.args[0]) : process.cwd();
if (name) console.log("Setup for:", name);

stdout("Generate client-side programs...");
genClientPrograms(path, program.name).done(function () {
	stdout(" generated\n");
});
