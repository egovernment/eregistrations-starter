#!/usr/bin/env node

'use strict';

Error.stackTraceLimit = Infinity;

var resolve   = require('path').resolve
  , readFile  = require('fs2/read-file')
  , writeFile = require('fs2/write-file')
  , minify    = require('../scripts/minify')

  , now = Date.now
  , input = resolve(process.argv[2])
  , output = process.argv[3] ? resolve(process.argv[3]) : null;

readFile(input)(function (code) {
	var time = now();
	code = minify(code, { log: Boolean(output) });
	if (!output) {
		console.log(code);
		return;
	}
	console.log("Minified in " + ((now() - time) / 1000).toFixed(2) + "s");
	return writeFile(output, code);
}).done();
