// Generates app html index file
// In future this script would be obsolete, as complete html would be configured in a views

'use strict';

var ensureObject    = require('es5-ext/object/valid-object')
  , ensureString    = require('es5-ext/object/validate-stringifiable-value')
  , resolveTemplate = require('es6-template-strings')
  , readFile        = require('fs2/read-file')
  , writeFile       = require('fs2/write-file')

  , writeOpts = { intermediate: true };

module.exports = function (templatePath, destPath, env) {
	var stRoot;
	templatePath = ensureString(templatePath);
	destPath = ensureString(destPath);
	ensureObject(env);
	stRoot = (env.static && env.static.host) || '/';
	return readFile(templatePath)(function (template) {
		return writeFile(destPath, resolveTemplate(template, { stRoot: stRoot }), writeOpts);
	});
};
