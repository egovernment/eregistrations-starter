'use strict';

var deferred    = require('deferred')
  , exec        = deferred.promisify(require('child_process').exec)
  , path        = require('path')
  , resolveApps = require('./resolve-apps')

  , resolve = path.resolve, stringify = JSON.stringify
  , binPath  = 'node ' + stringify(resolve(__dirname, '../bin/generate-client-models')) + ' ';

module.exports = function (path/*, name*/) {
	return resolveApps(path, arguments[1]).map(function (app) {
		return exec(binPath + stringify(app.root), { env: process.env });
	});
};
