'use strict';

var forEach = require('es5-ext/object/for-each')
  , mapKeys = require('es5-ext/object/map-keys')

  , create = Object.create;

module.exports = function (base, other, name) {
	var controllers = create(null);
	forEach(base, function (value, name) {
		var controller = controllers[name] = {};
		if (value.match) {
			controller.match = value.match;
			controller.validate = value.load;
		} else {
			controller.validate = value;
		}
	});
	forEach(other, function (value, name) {
		if (!controllers[name]) controllers[name] = value;
		else controllers[name].controller = value;
	});
	if (!name) return controllers;
	return mapKeys(controllers, function (key) {
		return name + ((key === '/&') ? '&' : ('/' + key));
	});
};
