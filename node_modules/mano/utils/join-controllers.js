'use strict';

var assign  = require('es5-ext/object/assign')
  , copy    = require('es5-ext/object/copy')
  , forEach = require('es5-ext/object/for-each');

module.exports = function (a, b) {
	var result = copy(a);
	if (!b) return result;
	forEach(a, function (conf, key) {
		if (!b[key]) return;
		if (conf === true) conf = result[key] = {};
		else conf = result[key] = copy(result[key]);
		assign(conf, b[key]);
	});
	forEach(b, function (conf, key) {
		if (result[key]) return;
		result[key] = conf;
	});
	return result;
};
