'use strict';

var endsWith   = require('es5-ext/string/#/ends-with')
  , some       = require('es5-ext/object/some')
  , db         = require('mano').db
  , clientHash = require('../../utils/client-hash');

module.exports = function (data) {
	some(data, function (value, name) {
		var user, userId;
		if (endsWith.call(name, '/password')) {
			userId = name.slice(0, -'/password'.length);
			user = db.User.getById(userId);
			data[name] = clientHash(user.email, value);
			return true;
		}
		return false;
	});
	return '/change-password-x/';
};
