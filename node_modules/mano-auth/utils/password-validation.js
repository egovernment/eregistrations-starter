/** Does standard password validation across eregistrations systems **/

'use strict';

var Password = require('mano').db.Password
  , customError  = require('es5-ext/error/custom');

module.exports = function (pwd, pwdRepeat) {
	pwd = Password.validate(pwd);
	if (pwd !== pwdRepeat) {
		throw customError("Passwords don't match",
			'PASSWORD_MISMATCH', { statusCode: 400, fieldName: 'password-repeat' });
	}
	return pwd;
};
