'use strict';

var customError = require('es5-ext/error/custom')
  , isId        = require('time-uuid/is-time-uuid')
  , db          = require('mano').db;

exports.email = db.Email;
exports.password = db.Password;

exports['password-repeat'] = function (data) {
	if (data.password !== data['password-repeat']) {
		throw customError("Passwords doesn't match", "PASSWORD_MISMATCH",
			{ statusCode: 400 });
	}
};

exports['password-token'] = function (data, env) {
	if (!isId(data['password-token'])) {
		throw customError("Cannot process request", "MALFORMED_ID",
			{ statusCode: 400 });
	}
};
