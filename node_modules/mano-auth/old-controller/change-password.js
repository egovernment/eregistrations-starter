'use strict';

var customError = require('es5-ext/error/custom')
  , endsWith    = require('es5-ext/string/#/ends-with')
  , some        = require('es5-ext/object/some')
  , Password    = require('mano').db.Password;

module.exports = function (data) {
	if (!some(data, function (value, name) {
			if (endsWith.call(name, '/password')) {
				value = Password.validate(value);
				return true;
			}
			return false;
		})) {
		throw customError("Missing value", "NO_PASSWORD", { statusCode: 400 });
	}
};
