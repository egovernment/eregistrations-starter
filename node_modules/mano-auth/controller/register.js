'use strict';

var copyDeep     = require('es5-ext/object/copy-deep')
  , dbjsValidate = require('mano/lib/utils/dbjs-form-validate')
  , passwordValidation = require('../utils/password-validation');

exports.validate = function (data) {
	var normalizedData = copyDeep(data);
	dbjsValidate(normalizedData, { partial: true });
	normalizedData['User#/password'] = passwordValidation(normalizedData['User#/password'],
		normalizedData['password-repeat']);
	delete normalizedData['password-repeat'];

	return normalizedData;
};
