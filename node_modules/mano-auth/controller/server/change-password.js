'use strict';

var _        = require('mano').i18n.bind('authentication')
  , dbjsSave = require('mano/lib/utils/dbjs-form-save')
  , hash     = require('../../hash');

exports.submit = function (data) {
	return hash.hash(data[this.propertyKey])(function (password) {
		data[this.propertyKey] = password;
		dbjsSave(data);
		return { message: _("Password successfully changed") };
	}.bind(this));
};
