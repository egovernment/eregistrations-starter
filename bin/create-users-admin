#!/usr/bin/env node

'use strict';

if (!process.env.DEBUG) process.env.DEBUG = '*';

require('../env');
require('../i18n');

require('../model/user/roles');
require('dbjs-ext/string/string-line/password')(require('../db'));

var debug    = require('debug-ext')('load')
  , dbDriver = require('../server/db/persistent')
  , stdout   = process.stdout.write.bind(process.stdout);

debug.open('db data');
dbDriver.loadAll().on('progress', debug.progress).done(function (events) {
	stdout(' [' + events.length + ' objects]');
	debug.close();
	require('eregistrations/scripts/create-users-admin')(dbDriver);
});
